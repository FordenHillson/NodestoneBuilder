<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
        <link rel="stylesheet" href="style.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>     
        <script type="text/javascript" src="control.js" defer></script>
        <script async src="opencv.js" type="text/javascript"></script>
    </head>
    <body onload="loadJSON()">
        <div class="container">
            <div class="row">
              <div class="col-12 mt-4" style="text-align:center">
                <h1 style="text-align:center">Nodestone Builder</h1>
                <h5 style="text-align:center">By AethericSky of GMS Reboot</h5>
              </div>
              <div class="col-12 mt-4">
                <table>
                  <thead>
                    <tr>
                      <th>Select Job: </th>
                      <th><select name="jobSelect" id="jobSelect" onchange="skillChange()">
                        <option value="">Select Job</option></th>
                      </select>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td id="openCVStatus">OpenCV is Loading</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <br/>
            <div class="container" id="normalOperation" name="hiddenObj">
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section1')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Tri-Node Skill Select</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-up-square-fill" style="line-height: inherit;" id="section1Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse show" id="section1">
                <div class="row" id="skillPicker">
                  <div class="col-12 mt-2">
                    <table class="table table-bordered" id="pickerNode">
                      <thead>
                        <tr>
                          <th scope="col" colspan="5">Select Skills</th>
                        </tr>
                      </thead>
                      <tbody id="skillOption1">

                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
              <br/>
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section1p5')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Tri-Node Creator</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-up-square-fill" style="line-height: inherit;" id="section1p5Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse show" id="section1p5">
                <div class="row" id="skillPicker2">
                  <div class="col-12 mt-2 table-responsive">
                    <table class="table table-bordered" id="pickerTriNode">
                      <thead>
                        <tr>
                          <th scope="col" colspan="20">Select Skills</th>
                        </tr>
                        <tr>
                          <th scope="col">Skill</th>
                          <th scope="col">1</th>
                          <th scope="col">2</th>
                          <th scope="col">3</th>
                          <th scope="col">Skill</th>
                          <th scope="col">1</th>
                          <th scope="col">2</th>
                          <th scope="col">3</th>
                          <th scope="col">Skill</th>
                          <th scope="col">1</th>
                          <th scope="col">2</th>
                          <th scope="col">3</th>
                          <th scope="col">Skill</th>
                          <th scope="col">1</th>
                          <th scope="col">2</th>
                          <th scope="col">3</th>
                          <th scope="col">Skill</th>
                          <th scope="col">1</th>
                          <th scope="col">2</th>
                          <th scope="col">3</th>
                        </tr>
                      </thead>
                      <tbody id="skillOption1p5">

                      </tbody>
                    </table>
                    <table class="table" id="pickerTriPreview">
                      <thead>
                        <tr>
                          <th>Current Selection Preview</th>
                          <th class="widthCreate2" id="previewPhoto">                                  
                            <img src="Images/MapleDivider.png" name="firstSlice" id="prev1a"/>
                            <img src="Images/MapleDivider.png" name="secondSlice" id="prev2a"/>
                            <img src="Images/MapleDivider.png" name="thirdSlice" id="prev3a"/>
                            <img src="Images/MapleDivider.png" name="divider"/>
                          </th>
                          <th id="textSel1"></th>
                          <th id="textSel2"></th>
                          <th id="textSel3"></th>
                          <th>
                            <button type="button" class="btn btn-primary" onclick="addNodestone2()">Add Nodestone</button>
                          </th>
                        </tr>
                      </thead>
                    </table>
                  </div>
                </div>
              </div>
              <br/>
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section2')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Nodestone Collection</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-up-square-fill" style="line-height: inherit;" id="section2Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse show" id="section2">
                <div class="row">
                  <div id="rightCreator">
                    <table class="table" id="nodeList" name="sortable">
                        <thead>
                            <tr>
                              <th scope="col">Trinode Skills</th>
                              <th scope="col"> </th>
                              <th scope="col">Node Score</th>
                              <th scope="col">Add</th>
                              <th scope="col">Delete</th>
                            </tr>
                          </thead>
                          <tbody>
                          </tbody>
                    </table>
                  </div>
                </div>
              </div>
              <br/>
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section3')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Current Trinode Setup</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-up-square-fill" style="line-height: inherit;" id="section3Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse show" id="section3">
                <div class="row">
                  <div class="col-6" id="leftCombo">
                    <table class="table" id="nodeCombo" name="sortable">
                      <thead>
                          <tr>
                            <th scope="col" colspan="2">Trinode Skills</th>
                            <th scope="col">Delete</th>
                          </tr>
                      </thead>
                      <tbody>
                      </tbody>
                    </table>
                  </div>
                  <div class="col-6" id="rightCombo">
                    <table class="table" id="controlCenter">
                      <thead>
                        <tr>
                          <th scope="col" colspan="3">Trinode Builder Options</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td scope="col"><button type="button" class="btn btn-primary" id="autoBuild" onclick="printCombination()">Auto Build [Sync]</button></td>
                          <td scope="col"><button type="button" class="btn btn-primary" id="autoBuild" onclick="buildPerfectTri()">Auto Build [Async]</button></td>
                          <td scope="col"><button type="button" class="btn btn-primary" id="autoBuild" onclick="autoButtonClick3()">Unequip All Trios</button></td>
                        </tr>
                        <tr>
                          <td scope="col">Number of Copies per Skill</td>
                          <td scope="col" colspan="2" class="centralizer">
                            <select name="copyNumber" id="copyNumber" onchange="numberChange()">
                              <option value=2>2</option>
                              <option value=3>3</option>
                              <option value=4>4</option>
                              <option value=5>5</option>
                              <option value=6>6</option>
                            </select>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <table class="table" id="nodeStatistics1">
                      <thead>
                          <tr>
                            <th scope="col" colspan="2">Node Combination Statistics</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr>
                            <td scope="col"><strong>Total Skills Selected</strong></td>
                            <td scope="col" name="skillCounter"></td>
                          </tr>
                          <tr>
                            <td scope="col"><strong># of Slots(If All Perfect Trios)</strong></td>
                            <td scope="col" name="bestOutcome"></td>
                          </tr>
                          <tr>
                            <td scope="col"><strong>Node Slots Used</strong></td>
                            <td scope="col" name="nodeUsage"></td>
                          </tr>
                          <tr>
                            <td scope="col"><strong>Node Efficiency</strong></td>
                            <td scope="col" name="nodeEfficiency"></td>
                          </tr>
                      </tbody>
                    </table>
                    <table class="table" id="nodeStatistics2" name="sortable">
                      <thead>
                          <tr>
                            <th scope="col">Skill</th>
                            <th scope="col">Selected</th>
                            <th scope="col">Occupied Slots</th>
                          </tr>
                      </thead>
                      <tbody>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="container" id="helpOperation" name="noOp">
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section35')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Help</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-down-square-fill" style="line-height: inherit;" id="section35Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse" id="section35">
                <h3>How to use</h3>
                <hr/>
                <h5>1. Select the job you want to build your tri-nodes</h5>
                <p>Click the dropdown box and select your class.</p>
                <div class="container mx-auto text-center">
                  <img src="Images/step1.PNG" class="img-fluid" alt="Select your class">
                </div>
                <h5>2. Select the skills you need to build your tri-nodes around</h5>
                <p>Click on the skills you want to select. Those highlighted in blue are currently selected.</p>
                <div class="container mx-auto text-center">
                  <img src="Images/step2.PNG" class="img-fluid" alt="Select your desired skills">
                </div>
                <h5>3. Create the tri-nodes you currently have.</h5>
                <p>Create your tri-nodes by clicking the corresponding column beside the skill icon based on its location in your trinode (1 being the leading skill). Upon clicking "Add Nodestone", the created nodestone will be added to the list below.</p>
                <div class="container mx-auto text-center">
                  <img src="Images/step3p1b.PNG" class="img-fluid" alt="Recreate the tri-nodes you own">
                </div>
                <h6>Created Nodestone Collection Legend</h6>
                <div class="container mx-auto text-center">
                  <img src="Images/step32.PNG" class="img-fluid" alt="Nodestone Collection UI">
                </div>
                <ol>
                  <li>Shows the skills enhanced by the tri-node</li>
                  <li>Shows the tri-node skill image</li>
                  <li>Shows the Node Score</li>
                  <li>Adds the tri-node to the "equipped" tri-nodes list</li>
                  <li>Deletes the tri-node from the list (Available only when there are no tri-nodes equipped)</li>
                </ol>
                <h6>Node Score</h6>
                <p>To facilitate the user in building their tri-node set, Each tri-node is given a score that updates based on the current nodestones equipped.</p>
                <table class="table">
                  <thead>
                    <tr>
                      <th scope="col">Score</th>
                      <th scope="col">Meaning</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td scope="col">6</td>
                      <td scope="col">A Perfect Tri-Node</td>
                    </tr>
                    <tr>
                      <td scope="col">1-5</td>
                      <td scope="col">The Tri-Node will not fully contribute to your desired tri-node set (Some skills may not be part of your desired list of skills or two copies of some of the skill are already present in your currently equipped tri-nodes)</td>
                    </tr>
                    <tr>
                      <td scope="col">0</td>
                      <td scope="col">The Tri-Node contains no skill that is part of your desired skills to enhance</td>
                    </tr>
                    <tr>
                      <td scope="col">-1 (In Use)</td>
                      <td scope="col">The Tri-Node Is Currently Equipped</td>
                    </tr>
                    <tr>
                      <td scope="col">-1 (Leading Skill)</td>
                      <td scope="col">The Tri-Node's Leading Skill is already present in your currently equipped tri-nodes</td>
                    </tr>
                  </tbody>
                </table>
                <p>Tip: You can click the header (Trinode Skills, and Node Score) to sort the nodes in alphabetical order (A->Z or Z->A) or to sort the nodes based on their current node score (ascending or descending)</p>
                <h5>4. Check the Statistics</h5>
                <p>You may unequip nodes by clicking the "Remove" button beside the currently equipped nodes</p>
                <div class="container mx-auto text-center">
                  <img src="Images/step41.PNG" class="img-fluid" alt="Check and Unequip your tri-nodes">
                </div>
                <h6>Node Statistics</h6>
                <div class="container mx-auto text-center">
                  <img src="Images/step42.PNG" class="img-fluid" alt="Node Statistics UI">
                </div>
                <ol>
                  <li>Shows how many skills were selected.</li>
                  <li>Gives an estimate of how many nodes it would take to most efficiently get 2 copies of each skill selected</li>
                  <li>Shows how many node slots are currently used</li>
                  <li>Shows how many node "skill slots"(3 per node) is used efficiently (ie. The skill is selected and has 2 or less total copies in the equipped node slots)[Note: Only jobs that need "multiples of 3" amounts of boosted skills expect a 100% Node efficiency]</li>
                  <li>Gives a breakdown of each skill and how many times it has already appeared in the equipped nodes.</li>
                </ol>
                <p>Tip: You can click the header (Skill, Selected, Occupied Slots) to sort them in order</p>
                <h5>5. Saving and Loading</h5>
                <div class="container mx-auto text-center">
                  <img src="Images/step5.PNG" class="img-fluid" alt="Save and Load Nodelist">
                </div>
                <p>By clicking the "Generate Nodelist" button, you can generate a list of the nodestones you currently have. Be sure to save it somewhere.</p>
                <p>By pasting the generated text and clicking the "Load List" button, your nodes will automatically be loaded in.</p>
              </div>
            </div>
            <br/>
            <div class="container" id="saveLoadContainer" name="noOp">
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section4')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Save or Load Nodelist</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-up-square-fill" style="line-height: inherit;" id="section4Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse show" id="section4">
                <div class="row" style="padding-bottom:15px">
                  <div class="col-12" id="saveLoad">
                    <textarea id="saveLoadArea" rows="8"></textarea>
                    <br/>
                    <button type="button" class="btn btn-primary" onclick="genList()">Generate Nodelist</button>
                    <button type="button" class="btn btn-primary" onclick="loadList()">Load Nodelist</button>
                  </div>
                </div>
              </div>
            </div>
            <br/>
            <div class="container" id="nodePhotoLoader" name="hiddenObj">
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section45')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Load Nodes from Photo</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-up-square-fill" style="line-height: inherit;" id="section45Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse show" id="section45">
                <div class="row" style="padding-bottom:15px">
                  <div class="col-12" id="photoLoadContainer">
                    <p>Click here and then use Ctrl-V to paste your snips or the image file. Click the photo remove it.</p>
                    <div class="col-12" id="uploadedPhotos" style="padding-bottom:15px"></div>
                    <button type="button" class="btn btn-primary" id="photoRead" onclick="readPhotos()">Load via Photos</button>
                  </div>
                </div>
              </div>
            </div>
            <br/>
            <div class="container" id="optionOperation" name="hiddenObj">
              <nav class="navbar navbar-expand-sm bg-primary navbar-dark nav-fill w-100" onclick="divcollapse('section5')">
                <ul class="navbar-nav nav-fill w-100">
                  <li class="nav-item active">
                    <h3 style="text-align:left">Options</h3>
                  </li>
                  <li class="nav-item" style="text-align:right">
                    <i class="bi bi-caret-up-square-fill" style="line-height: inherit;" id="section5Arrow"></i>
                  </li>
                </ul>
              </nav>
              <div class="container-fluid border collapse show" id="section5">
                <div class="row">
                  <div class="col-12" id="optionsArea">
                    <table class="table table">
                      <tbody>
                        <tr>
                          <td>
                            <strong>Region/Language (Placeholder)</strong>
                          </td>
                          <td>                       
                              <select name="language" id="language">
                                <option value="EN1">[GMS] English</option>
                              </select>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <strong>Number of Copies Per Skill (Beta - Computations not Confirmed)</strong>
                          </td>
                          <td>                       
                            <!--  <select name="copyNumber" id="copyNumber" onchange="numberChange()">
                                <option value="2">2 (Lv. 25 / Lv. 25)</option>
                                <option value="3">3 (Lv. 16 / Lv. 17 / Lv. 17)</option>
                              </select> -->
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            </br>
            <button type="button" class="btn btn-primary invisible" id="autoBuild" onclick="printCombination()">Auto Build</button>
            <button type="button" class="btn btn-primary invisible" id="autoBuild" onclick="buildPerfectTri()">Auto Build [Web Worker]</button>
            <button type="button" class="btn btn-primary invisible" onclick="checkVar()">Check Variables</button>
        </div>
    </body>
    <script type="text/javascript"> 
      var Module = {
      // https://emscripten.org/docs/api_reference/module.html#Module.onRuntimeInitialized
      onRuntimeInitialized() {
      document.getElementById('openCVStatus').remove();
      preLoad();
      }
  };</script>
</html>